<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>نموذج التسجيل</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css"
    integrity="sha384-nU14brUcp6StFbqo8Pp2Juk4kyP0xyvgCytCzKPUwRxspnvJEZgCRcKyிகிஃ" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

<style>
/* Custom scrollbar styling for all browsers */
body, html, ::-webkit-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: #9b87f5 #f1f0fb;
}
body::-webkit-scrollbar, 
.preview-area::-webkit-scrollbar {
  width: 10px;
  background: #f1f0fb;
}
body::-webkit-scrollbar-thumb, 
.preview-area::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, #9b87f5 40%, #7E69AB 100%);
  border-radius: 8px;
  border: 2px solid #f1f0fb;
  min-height: 60px;
}
body::-webkit-scrollbar-track, 
.preview-area::-webkit-scrollbar-track {
  background-color: #f1f0fb;
  border-radius: 10px;
}
body {
  /* Make body responsive and modern look */
  font-family: "Cairo", Arial, sans-serif;
  background: #F1F0FB;
  margin: 0;
  padding: 0;
  min-height: 100vh;
}

/* Responsive upload area and preview image */
.upload-container {
  position: relative;
  background: white;
  border-radius: 22px;
  box-shadow: 0 8px 32px rgba(80,60,160,0.06);
  transition: box-shadow 0.3s;
  margin-bottom: 2rem;
  width: 100%;
  max-width: 420px;
  margin-left: auto;
  margin-right: auto;
  padding: 38px 24px;
}
.upload-container:hover {
  box-shadow: 0 12px 48px rgba(80,60,160,0.11);
}
.upload-label {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  transition: color .2s;
}
.upload-label .icon {
  font-size: 3.0em;
  color: #9b87f5;
  margin-bottom: 10px;
  transition: color .25s;
}
.upload-label span, .upload-label .icon {
  user-select: none;
  pointer-events: none;
}
.upload-label[hidden] {
  display: none !important;
}
#image-preview-container {
  display: none;
  position: relative;
  justify-content: center; 
  align-items: center;
  width: 100%;
}
#image-preview-container img {
  max-width: 280px;
  max-height: 180px;
  width: auto;
  height: auto;
  border-radius: 20px;
  cursor: pointer;
  box-shadow: 0 4px 24px rgba(130,100,208,0.18);
  transition: box-shadow .2s, transform .2s;
}
#image-preview-container img:hover {
  box-shadow: 0 12px 32px rgba(80,60,160,0.14);
  transform: scale(1.03) rotate(-2deg);
}

@media (max-width: 600px) {
  .upload-container {
    padding: 18px 8px;
  }
  #image-preview-container img {
    max-width: 240px;
    max-height: 110px;
  }
}

/* Animated fade-in for preview state */
@keyframes fadeInModern {
  from { opacity: 0; transform: scale(.95)}
  to { opacity: 1; transform: scale(1)}
}
#image-preview-container {
  animation: fadeInModern .35s;
}
 
/* File list/preview area */
.preview-area {
  background: #fff;
  box-shadow: 0 4px 28px rgba(114,88,198,0.08);
  border-radius: 16px;
  padding: 32px 18px 20px 18px;
  margin: 16px auto;
  max-width: 600px;
  width: 100%;
  overflow-y: auto;
}
.preview-file-block {
  position: relative;
  margin-bottom: 2.5em;
  padding-top: 1.9em;
  border-bottom: 1px solid #eee;
}
.preview-file-title {
  font-size: 1.18em;
  font-weight: 600;
  color: #715ab2;
  display: flex;
  align-items: center;
}
.download-btn {
  all: unset;
  cursor: pointer;
  background: linear-gradient(90deg, #9b87f5, #1EAEDB 85%);
  color: #fff;
  padding: 8px 18px 8px 38px;
  border-radius: 20px;
  font-weight: 600;
  box-shadow: 0 4px 16px #9872e314;
  font-size: 0.99em;
  margin-left: auto;
  transition: background .2s,box-shadow .18s, transform .15s;
  position: absolute;
  right: 0;
  top: 0;
  display: flex;
  align-items: center;
  gap: 7px;
}
.download-btn:hover {
  background: linear-gradient(90deg,#7E69AB 0,#33C3F0 95%);
  transform: translateY(-2px) scale(1.04) rotate(-2deg);
  box-shadow: 0 8px 32px #9b87f52d;
}
.download-btn svg {
  margin-right: 5px;
  font-size: 1.3em;
}

/* Name stays aligned with download button */
.preview-file-title {
  padding-right: 124px;
}
/* Responsive fixes */
@media (max-width: 480px) {
  .preview-area {
    padding: 14px 3px 13px 3px;
  }
  .preview-file-block {
    padding-top: 1.4em;
  }
  .preview-file-title {
    font-size: 1em;
    padding-right: 72px;
  }
  .download-btn {
    padding: 6px 12px 6px 30px;
    font-size: 0.93em;
    right: 4px;
  }
}

/* General UI polish */
button, input[type="file"] {
  outline: none;
  border: none;
}
input[type="file"] {
  display: none;
}
</style>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="#">
        <img src="holder.js/30x30" width="30" height="30" class="d-inline-block align-top" alt="">
        اسم الموقع
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">الرئيسية</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">الميزات</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">التسعير</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">معطل</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <h1>نموذج التسجيل</h1>
    <p>يرجى ملء النموذج أدناه للتسجيل.</p>
  </div>

  <div id="main-content">
    <div class="upload-container" id="upload-box">
      <label class="upload-label" for="image-upload" id="upload-label">
        <span class="icon">📷</span>
        <span style="font-size:1.10em;color:#816EB7;font-weight:600;">اختر الصوره</span>
        <span style="font-size:0.98em;color:#444B5C;margin-top:8px;">اختر صورة من جهازك<br>أقصى حجم 5MB</span>
      </label>
      <input type="file" accept="image/*" id="image-upload" />
      <div id="image-preview-container" class="centered"></div>
    </div>
    <form id="myForm">
      <div class="mb-3">
        <label for="name" class="form-label">الاسم:</label>
        <input type="text" class="form-control" id="name" name="name" required>
      </div>

      <div class="mb-3">
        <label for="email" class="form-label">البريد الإلكتروني:</label>
        <input type="email" class="form-control" id="email" name="email" required>
      </div>

      <div class="mb-3">
        <label for="phone" class="form-label">رقم الهاتف:</label>
        <input type="tel" class="form-control" id="phone" name="phone" required>
      </div>

      <div class="mb-3">
        <label for="country" class="form-label">الدولة:</label>
        <select class="form-select" id="country" name="country" required>
          <option value="">اختر الدولة</option>
          <option value="saudi_arabia">المملكة العربية السعودية</option>
          <option value="egypt">مصر</option>
          <option value="jordan">الأردن</option>
          <!-- يمكنك إضافة المزيد من الدول هنا -->
        </select>
      </div>

      <div class="mb-3">
        <label for="city" class="form-label">المدينة:</label>
        <input type="text" class="form-control" id="city" name="city" required>
      </div>

      <div class="mb-3">
        <label for="address" class="form-label">العنوان:</label>
        <textarea class="form-control" id="address" name="address" rows="3" required></textarea>
      </div>

      <div class="mb-3">
        <label for="gender" class="form-label">الجنس:</label>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="gender" id="male" value="male" required>
          <label class="form-check-label" for="male">
            ذكر
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="gender" id="female" value="female" required>
          <label class="form-check-label" for="female">
            أنثى
          </label>
        </div>
      </div>

      <div class="mb-3">
        <label for="birthdate" class="form-label">تاريخ الميلاد:</label>
        <input type="date" class="form-control" id="birthdate" name="birthdate" required>
      </div>

      <div class="mb-3">
        <label for="nationality" class="form-label">الجنسية:</label>
        <select class="form-select" id="nationality" name="nationality" required>
          <option value="">اختر الجنسية</option>
          <option value="saudi">سعودي</option>
          <option value="egyptian">مصري</option>
          <option value="jordanian">أردني</option>
          <!-- يمكنك إضافة المزيد من الجنسيات هنا -->
        </select>
      </div>

      <div class="mb-3">
        <label for="skills" class="form-label">المهارات:</label>
        <select class="js-example-basic-multiple form-control" id="skills" name="skills" multiple="multiple"
          required>
          <option value="programming">البرمجة</option>
          <option value="design">التصميم</option>
          <option value="marketing">التسويق</option>
          <!-- يمكنك إضافة المزيد من المهارات هنا -->
        </select>
      </div>

      <div class="mb-3">
        <label for="experience" class="form-label">الخبرة:</label>
        <textarea class="form-control" id="experience" name="experience" rows="3" required></textarea>
      </div>

      <button type="submit" class="btn btn-primary">إرسال</button>
    </form>
  </div>

  <div id="preview-area" class="preview-area" style="display:none;"></div>

<script>
// ----------- HANDLE IMAGE UPLOAD & MODERN PREVIEW ----------
const imageInput = document.getElementById("image-upload");
const previewContainer = document.getElementById("image-preview-container");
const uploadLabel = document.getElementById("upload-label");

imageInput.addEventListener('change', function() {
  if (!this.files || !this.files[0]) return;
  // Hide all upload label area after image, and show the preview
  uploadLabel.hidden = true;
  previewContainer.innerHTML = "";
  const img = document.createElement('img');
  img.alt = "الصورة المختارة";
  img.title = "تغيير الصورة";
  img.className = "modern-img-thumbnail";
  const file = this.files[0];
  img.src = URL.createObjectURL(file);
  // Clicking image will trigger upload input for new image, modern and space-saving
  img.onclick = () => { imageInput.value = ""; imageInput.click(); };
  previewContainer.appendChild(img);
  previewContainer.style.display = "flex";
});

// Optional: On page load, reset state
window.addEventListener('DOMContentLoaded', function() {
  uploadLabel.hidden = false;
  previewContainer.innerHTML = "";
  previewContainer.style.display = "none";
});


/* --------- PDF PREVIEW AREA IMPROVEMENTS ------------- */

// Dummy demo code for updating preview (must be called from your app logic)
function showPreviewArea(files) {
  const preview = document.getElementById("preview-area");
  if (!files || files.length === 0) {
    preview.style.display = "none";
    preview.innerHTML = "";
    return;
  }
  preview.innerHTML = "";
  preview.style.display = "";
  files.forEach(f => {
    const block = document.createElement("div");
    block.className = "preview-file-block";
    block.innerHTML =
      `<div class="preview-file-title">${escapeHtml(f.name)}
        <button class="download-btn" onclick="downloadPdf('${encodeURIComponent(f.id)}', '${escapeHtml(f.name)}')" title="تحميل PDF">
          <svg height="18" width="18" viewBox="0 0 24 24" fill="none"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4m16-5-7 7m0 0-7-7m7 7V3" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          تحميل
        </button>
      </div>
      <iframe src="${escapeHtml(f.url)}" style="width:100%;min-height:350px;background:#fafafa;border-radius:12px;margin-top:11px;border:none;box-shadow: 0 2px 18px #9b87f51a;"></iframe>`;
    preview.appendChild(block);
  });
}

// Helper to escape HTML
function escapeHtml(txt) {
  return String(txt).replace(/[&<>"']/g, function(m) {
    return {"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"}[m];
  });
}

function downloadPdf(id, name) {
  // Download logic. This should connect to your Apps Script/files backend.
  google.script.run.downloadPdf(id, name);
}

// ------- On Successful File Submission, Auto-navigate to Preview ---------
function handleFormSubmitSuccess(filesCreated) {
  // "filesCreated" should be an array of objects: {id, name, url}
  showPreviewArea(filesCreated);
  // Scroll to the preview area with smooth animation
  document.getElementById("preview-area").scrollIntoView({behavior: "smooth", block: "center"});
}

// Replace this comment with your form's submit logic, call handleFormSubmitSuccess when done successfully
// Example: document.getElementById("my-form").onsubmit = async function(e) { ... handleFormSubmitSuccess(myfiles); }
document.getElementById("myForm").onsubmit = async function(e) {
  e.preventDefault(); // Prevent the default form submission

  // Collect form data
  const formData = {
    name: document.getElementById("name").value,
    email: document.getElementById("email").value,
    phone: document.getElementById("phone").value,
    country: document.getElementById("country").value,
    city: document.getElementById("city").value,
    address: document.getElementById("address").value,
    gender: document.querySelector('input[name="gender"]:checked').value,
    birthdate: document.getElementById("birthdate").value,
    nationality: document.getElementById("nationality").value,
    skills: Array.from(document.getElementById("skills").selectedOptions).map(option => option.value),
    experience: document.getElementById("experience").value
  };

  // Call the Apps Script function
  google.script.run.withSuccessHandler(function(response) {
    if (response.status === "success") {
      handleFormSubmitSuccess(response.files); // Call the success handler with the files
    } else {
      alert("Error submitting form: " + response);
    }
  }).submitDataAndPreview(formData);
};
</script>
  <footer class="bg-light text-center py-3">
    <p>&copy; 2024 جميع الحقوق محفوظة.</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script>
    $(document).ready(function () {
      $('.js-example-basic-multiple').select2({
        placeholder: "اختر المهارات",
        dir: "rtl"
      });
    });
  </script>
  <script src="holder.js"></script>
</body>

</html>
